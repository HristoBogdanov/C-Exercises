CREATE DATABASE Reki_svqt

use Reki_svqt

CREATE TABLE Continents(
code nvarchar(2) PRIMARY KEY,
ime nvarchar(50) UNIQUE, 
)

go

CREATE TABLE Countries(
code nvarchar(2) PRIMARY KEY,
ime nvarchar(50) UNIQUE NOT NULL,
ime_stolica nvarchar(50) NOT NULL
)

go

CREATE TABLE Rivers(
code int PRIMARY KEY,
ime nvarchar(50) NOT NULL,
duljina int NOT NULL
)

go

CREATE TABLE rivers_countries(
code_rivers int FOREIGN KEY
REFERENCES Rivers(code),
code_countries nvarchar(2) FOREIGN KEY
REFERENCES Countries(code)
)

go

ALTER TABLE Countries
ADD code_continent nvarchar(2) FOREIGN KEY
REFERENCES Continents(code)

go

INSERT Continents
VALUES ('AF', 'Africa'),
	   ('AN', 'Antarctica'),
	   ('AS', 'Asia'),
	   ('EU', 'Europe'),
	   ('NA', 'North America'),
	   ('OC', 'Oceania'),
	   ('SA', 'South America');


go

INSERT countries(code,ime,code_continent,ime_stolica)
VALUES ('AD', 'Andorra', 'EU','Andorra la Vella'),
	('AE', 'United Arab Emirates',  'AS', 'Abu Dhabi'),
	('AF',  'Afghanistan',  'AS',  'Kabul'),
	('AG',  'Antigua and Barbuda',  'NA', 'St. Jones'),
	('AI',  'Anguilla',  'NA', 'The Valley'),
	('AL',  'Albania', 'EU',  'Tirana'),
	('AM', 'Armenia',  'AS',  'Yerevan'),
	('AO',  'Angola',  'AF', 'Luanda'),
	('AQ',  'Antarctica',  'AN',  ''),
	('AR',  'Argentina', 'SA',  'Buenos Aires'),
	('AS',  'American Samoa',  'OC',  'Pago Pago'),
	('AT',  'Austria', 'EU', 'Vienna'),
	('AU', 'Australia',  'OC',  'Canberra'),
	('AW', 'Aruba',  'NA',  'Oranjestad'),
	('AZ',  'Azerbaijan',  'AS',  'Baku'),
	('BA',  'Bosnia and Herzegovina',  'EU',  'Sarajevo'),
	('BB',  'Barbados', 'NA', 'Bridgetown'),
	('BD',  'Bangladesh',  'AS',  'Dhaka'),
	('BE', 'Belgium',  'EU',  'Brussels'),
	('BF',  'Burkina Faso',  'AF','Ouagadougou'),
	('BG',  'Bulgaria','EU',  'Sofia'),
	('BH',  'Bahrain',  'AS', 'Manama'),
	('BI',  'Burundi',  'AF', 'Bujumbura'),
	('BJ', 'Benin', 'AF', 'Porto-Novo'),
	('BL',  'Saint Barthélemy',  'NA', 'Gustavia'),
	('BM', 'Bermuda', 'NA', 'Hamilton'),
	('BN',  'Brunei',  'AS','Bandar Seri Begawan'),
	('BO',  'Bolivia',  'SA', 'Sucre'),
	('BQ', 'Bonaire', 'NA', ''),
	('BR',  'Brazil',  'SA', 'Brasília'),
	('BS', 'Bahamas',  'NA','Nassau'),
	('BT',  'Bhutan',  'AS', 'Thimphu'),
	('BV', 'Bouvet Island',  'AN', ''),
	('BW', 'Botswana',  'AF',  'Gaborone'),
	('BY',  'Belarus',  'EU',  'Minsk'),
	('BZ',  'Belize',  'NA',  'Belmopan'),
	('CA', 'Canada',  'NA', 'Ottawa'),
	('CC',  'Cocos Islands',  'AS', 'West Island'),
	('CD',  'Democratic Republic of the Congo',  'AF',  'Kinshasa'),
	('CF', 'Central African Republic',  'AF',  'Bangui'),
	('CG',  'Republic of the Congo',  'AF',  'Brazzaville'),
	('CH', 'Switzerland', 'EU',  'Berne'),
	('CI',  'Ivory Coast',  'AF',  'Yamoussoukro'),
	('CK', 'Cook Islands',  'OC', 'Avarua'),
	('CL',  'Chile',  'SA',  'Santiago'),
	('CM',  'Cameroon',  'AF',  'Yaoundé'),
	('CN',  'China',  'AS',  'Beijing'),
	('CO', 'Colombia',  'SA',  'Bogotá'),
	('CR', 'Costa Rica',  'NA',  'San José'),
	('CU',  'Cuba',  'NA',  'Havana'),
	('CV',  'Cape Verde', 'AF',  'Praia'),
	('CW', 'Curacao',  'NA',  'Willemstad'),
	('CX',  'Christmas Island',  'AS',  'The Settlement'),
	('CY',  'Cyprus',  'EU',  'Nicosia'),
	('CZ',  'Czech Republic',  'EU',  'Prague'),
	('DE',  'Germany',  'EU',  'Berlin'),
	('DJ', 'Djibouti',  'AF',  'Djibouti'),
	('DK', 'Denmark',  'EU',  'Copenhagen'),
	('DM',  'Dominica',  'NA', 'Roseau'),
	('DO',  'Dominican Republic',  'NA',  'Santo Domingo'),
	('DZ',  'Algeria',  'AF',  'Algiers'),
	('EC',  'Ecuador',  'SA',  'Quito'),
	('EE',  'Estonia',  'EU',  'Tallinn'),
	('EG', 'Egypt',  'AF',  'Cairo'),
	('EH',  'Western Sahara',  'AF',  'El Aaiún'),
	('ER',  'Eritrea',  'AF', 'Asmara'),
	('ES', 'Spain',  'EU',  'Madrid'),
	('ET',  'Ethiopia',  'AF', 'Addis Ababa'),
	('FI',  'Finland',  'EU',  'Helsinki'),
	('FJ',  'Fiji',  'OC',  'Suva'),
	('FK', 'Falkland Islands',  'SA',  'Stanley'),
	('FM',  'Micronesia',  'OC',  'Palikir'),
	('FO',  'Faroe Islands',  'EU',  'Tórshavn'),
	('FR',  'France', 'EU',  'Paris'),
	('GA',  'Gabon',  'AF',  'Libreville'),
	('GB',  'United Kingdom', 'EU',  'London'),
	('GD',  'Grenada', 'NA', 'St. George'),
	('GE',  'Georgia', 'AS', 'Tbilisi'),
	('GF',  'French Guiana',  'SA',  'Cayenne'),
	('GG',  'Guernsey', 'EU',  'St Peter Port'),
	('GH',  'Ghana', 'AF',  'Accra'),
	('GI',  'Gibraltar', 'EU', 'Gibraltar'),
	('GL',  'Greenland', 'NA', 'Nuuk'),
	('GM',  'Gambia',  'AF',  'Banjul'),
	('GN', 'Guinea', 'AF', 'Conakry'),
	('GP',  'Guadeloupe', 'NA',  'Basse-Terre'),
	('GQ', 'Equatorial Guinea',  'AF', 'Malabo'),
	('GR', 'Greece',  'EU', 'Athens'),
	('GS',  'South Georgia and the South Sandwich Islands',  'AN',  'Grytviken'),
	('GT', 'Guatemala',  'NA', 'Guatemala City'),
	('GU',  'Guam',  'OC',  'Hagåtña'),
	('GW',  'Guinea-Bissau', 'AF',  'Bissau'),
	('GY',  'Guyana',  'SA',  'Georgetown'),
	('HK',  'Hong Kong', 'AS',  'Hong Kong'),
	('HM',  'Heard Island and McDonald Islands',  'AN',  ''),
	('HN',  'Honduras', 'NA', 'Tegucigalpa'),
	('HR',  'Croatia',  'EU', 'Zagreb'),
	('HT',  'Haiti',  'NA',  'Port-au-Prince'),
	('HU',  'Hungary', 'EU', 'Budapest'),
	('ID',  'Indonesia', 'AS',  'Jakarta'),
	('IE',  'Ireland',  'EU', 'Dublin'),
	('IL', 'Israel',  'AS',  'Jerusalem'),
	('IM',  'Isle of Man',  'EU',  'Douglas'),
	('IN', 'India',  'AS',  'New Delhi'),
	('IO', 'British Indian Ocean Territory',  'AS',  ''),
	('IQ',  'Iraq',  'AS',  'Baghdad'),
	('IR',  'Iran',  'AS', 'Tehran'),
	('IS',  'Iceland',  'EU',  'Reykjavik'),
	('IT',  'Italy',  'EU', 'Rome'),
	('JE',  'Jersey',  'EU',  'Saint Helier'),
	('JM',  'Jamaica', 'NA', 'Kingston'),
	('JO', 'Jordan',  'AS',  'Amman'),
	('JP',  'Japan',  'AS',  'Tokyo'),
	('KE', 'Kenya',  'AF', 'Nairobi'),
	('KG', 'Kyrgyzstan',  'AS', 'Bishkek'),
	('KH',  'Cambodia',  'AS',  'Phnom Penh'),
	('KI',  'Kiribati', 'OC', 'Tarawa'),
	('KM',  'Comoros', 'AF',  'Moroni'),
	('KN',  'Saint Kitts and Nevis',  'NA',  'Basseterre'),
	('KP',  'North Korea', 'AS',  'Pyongyang'),
	('KR',  'South Korea', 'AS',  'Seoul'),
	('KW', 'Kuwait',  'AS',  'Kuwait City'),
	('KY',  'Cayman Islands', 'NA',  'George Town'),
	('KZ',  'Kazakhstan', 'AS',  'Astana'),
	('LA',  'Laos', 'AS',  'Vientiane'),
	('LB',  'Lebanon',  'AS', 'Beirut'),
	('LC',  'Saint Lucia','NA',  'Castries'),
	('LI',  'Liechtenstein',  'EU',  'Vaduz'),
	('LK',  'Sri Lanka',  'AS', 'Colombo'),
	('LR',  'Liberia', 'AF',  'Monrovia'),
	('LS',  'Lesotho',  'AF', 'Maseru'),
	('LT', 'Lithuania',  'EU', 'Vilnius'),
	('LU', 'Luxembourg',  'EU', 'Luxembourg'),
	('LV', 'Latvia', 'EU',  'Riga'),
	('LY', 'Libya',  'AF',  'Tripoli'),
	('MA',  'Morocco',  'AF', 'Rabat'),
	('MC',  'Monaco',  'EU',  'Monaco'),
	('MD',  'Moldova',  'EU',  'Chisinau'),
	('ME',  'Montenegro',  'EU',  'Podgorica'),
	('MF',  'Saint Martin',  'NA', 'Marigot'),
	('MG',  'Madagascar',  'AF', 'Antananarivo'),
	('MH',  'Marshall Islands',  'OC',  'Majuro'),
	('MK',  'Macedonia', 'EU', 'Skopje'),
	('ML',  'Mali',  'AF', 'Bamako'),
	('MM', 'Myanmar', 'AS', 'Nay Pyi Taw'),
	('MN',  'Mongolia',  'AS',  'Ulan Bator'),
	('MO', 'Macao',  'AS', 'Macao'),
	('MP',  'Northern Mariana Islands',  'OC', 'Saipan'),
	('MQ', 'Martinique',  'NA',  'Fort-de-France'),
	('MR',  'Mauritania',  'AF',  'Nouakchott'),
	('MS',  'Montserrat',  'NA',  'Plymouth'),
	('MT',  'Malta', 'EU',  'Valletta'),
	('MU',  'Mauritius',  'AF',  'Port Louis'),
	('MV',  'Maldives',  'AS',  'Malé'),
	('MW',  'Malawi',  'AF',  'Lilongwe'),
	('MX', 'Mexico',  'NA',  'Mexico City'),
	('MY',  'Malaysia', 'AS', 'Kuala Lumpur'),
	('MZ', 'Mozambique',  'AF',  'Maputo'),
	('NA',  'Namibia', 'AF',  'Windhoek'),
	('NC', 'New Caledonia',  'OC',  'Noumea'),
	('NE', 'Niger',  'AF',  'Niamey'),
	('NF',  'Norfolk Island',  'OC', 'Kingston'),
	('NG', 'Nigeria',  'AF',  'Abuja'),
	('NI',  'Nicaragua',  'NA',  'Managua'),
	('NL',  'Netherlands',  'EU',  'Amsterdam'),
	('NO',  'Norway', 'EU',  'Oslo'),
	('NP',  'Nepal', 'AS',  'Kathmandu'),
	('NR', 'Nauru',  'OC',  ''),
	('NU', 'Niue',  'OC', 'Alofi'),
	('NZ',  'New Zealand', 'OC', 'Wellington'),
	('OM',  'Oman',  'AS',  'Muscat'),
	('PA',  'Panama',  'NA',  'Panama City'),
	('PE',  'Peru',  'SA', 'Lima'),
	('PF',  'French Polynesia',  'OC', 'Papeete'),
	('PG', 'Papua New Guinea',  'OC', 'Port Moresby'),
	('PH',  'Philippines',  'AS',  'Manila'),
	('PK',  'Pakistan',  'AS', 'Islamabad'),
	('PL', 'Poland',  'EU',  'Warsaw'),
	('PM',  'Saint Pierre and Miquelon',  'NA', 'Saint-Pierre'),
	('PN',  'Pitcairn Islands', 'OC',  'Adamstown'),
	('PR',  'Puerto Rico', 'NA',  'San Juan'),
	('PS',  'Palestine',  'AS',  ''),
	('PT',  'Portugal',  'EU',  'Lisbon'),
	('PW',  'Palau',  'OC',  'Melekeok - Palau State Capital'),
	('PY',  'Paraguay',  'SA',  'Asunción'),
	('QA',  'Qatar',  'AS',  'Doha'),
	('RE',  'Réunion',  'AF',  'Saint-Denis'),
	('RO', 'Romania',  'EU', 'Bucharest'),
	('RS',  'Serbia',  'EU',  'Belgrade'),
	('RU', 'Russia',  'EU', 'Moscow'),
	('RW',  'Rwanda', 'AF', 'Kigali'),
	('SA',  'Saudi Arabia',  'AS', 'Riyadh'),
	('SB',  'Solomon Islands', 'OC', 'Honiara'),
	('SC',  'Seychelles', 'AF', 'Victoria'),
	('SD',  'Sudan',  'AF',  'Khartoum'),
	('SE', 'Sweden',  'EU',  'Stockholm'),
	('SG', 'Singapore',  'AS',  'Singapore'),
	('SH', 'Saint Helena',  'AF', 'Jamestown'),
	('SI',  'Slovenia',  'EU', 'Ljubljana'),
	('SJ',  'Svalbard and Jan Mayen', 'EU',  'Longyearbyen'),
	('SK',  'Slovakia','EU',  'Bratislava'),
	('SL', 'Sierra Leone',  'AF', 'Freetown'),
	('SM', 'San Marino', 'EU',  'San Marino'),
	('SN',  'Senegal',  'AF',  'Dakar'),
	('SO',  'Somalia', 'AF',  'Mogadishu'),
	('SR',  'Suriname',  'SA', 'Paramaribo'),
	('SS',  'South Sudan',  'AF',  'Juba'),
	('ST', 'São Tomé and Príncipe', 'AF',  'São Tomé'),
	('SV', 'El Salvador',  'NA',  'San Salvador'),
	('SX', 'Sint Maarten',  'NA',  'Philipsburg'),
	('SY',  'Syria', 'AS', 'Damascus'),
	('SZ', 'Swaziland',  'AF',  'Mbabane'),
	('TC',  'Turks and Caicos Islands',  'NA', 'Cockburn Town'),
	('TD', 'Chad',  'AF',  'Djamena'),
	('TF',  'French Southern Territories', 'AN', 'Port-aux-Français'),
	('TG', 'Togo', 'AF', 'Lomé'),
	('TH',  'Thailand',  'AS',  'Bangkok'),
	('TJ', 'Tajikistan',  'AS',  'Dushanbe'),
	('TK',  'Tokelau',  'OC', ''),
	('TL',  'East Timor',  'OC',  'Dili'),
	('TM',  'Turkmenistan',  'AS',  'Ashgabat'),
	('TN',  'Tunisia', 'AF', 'Tunis'),
	('TO', 'Tonga',  'OC',  'Nuku-alofa'),
	('TR',  'Turkey',  'AS',  'Ankara'),
	('TT', 'Trinidad and Tobago',  'NA',  'Port of Spain'),
	('TV',  'Tuvalu',  'OC', 'Funafuti'),
	('TW', 'Taiwan',  'AS',  'Taipei'),
	('TZ', 'Tanzania',  'AF',  'Dodoma'),
	('UA', 'Ukraine',  'EU', 'Kyiv'),
	('UG',  'Uganda',  'AF', 'Kampala'),
	('UM',  'U.S. Minor Outlying Islands','OC',  ''),
	('US',  'United States',  'NA', 'Washington'),
	('UY', 'Uruguay',  'SA',  'Montevideo'),
	('UZ',  'Uzbekistan', 'AS',  'Tashkent'),
	('VA',  'Vatican City', 'EU', 'Vatican'),
	('VC', 'Saint Vincent and the Grenadines', 'NA',  'Kingstown'),
	('VE',  'Venezuela',  'SA',  'Caracas'),
	('VG',  'British Virgin Islands',  'NA',  'Road Town'),
	('VI',  'U.S. Virgin Islands',  'NA',  'Charlotte Amalie'),
	('VN', 'Vietnam',  'AS', 'Hanoi'),
	('VU',  'Vanuatu',  'OC', 'Port Vila'),
	('WF',  'Wallis and Futuna',  'OC', 'Mata-Utu'),
	('WS', 'Samoa',  'OC', 'Apia'),
	('XK', 'Kosovo',  'EU',  'Pristina'),
	('YE', 'Yemen',  'AS', 'Sanaa'),
	('YT',  'Mayotte',  'AF',  'Mamoutzou'),
	('ZA', 'South Africa',  'AF', 'Pretoria'),
	('ZM',  'Zambia',  'AF',  'Lusaka'),
	('ZW',  'Zimbabwe',  'AF',  'Harare');



go


INSERT rivers
VALUES (1, 'Nile', 6650),
	(2, 'Amazon', 6400),
	(3, 'Yangtze', 6300),
	(4, 'Mississippi', 6275),
	(5, 'Yenisei', 5539),
	(6, 'Yellow River', 5464),
	(7, 'Ob', 5410),
	(8, 'Paraná', 4880),
	(9, 'Congo', 4700),
	(10, 'Amur', 4444),
	(11, 'Lena', 4400),
	(12, 'Mekong', 4350),
	(13, 'Mackenzie', 4241),
	(14, 'Niger', 4200),
	(15, 'Murray', 3672),
	(16, 'Tocantins', 3650),
	(17, 'Volga', 3645),
	(18, 'Shatt al-Arab', 3596),
	(19, 'Madeira', 3380),
	(20, 'Purús', 3211),
	(21, 'Yukon', 3185),
	(22, 'Indus', 3180),
	(23, 'São Francisco', 3180),
	(24, 'Syr Darya', 3078),
	(25, 'Salween', 3060),
	(26, 'Saint Lawrence', 3058),
	(27, 'Rio Grande', 3057),
	(28, 'Lower Tunguska', 2989),
	(29, 'Brahmaputra', 2948),
	(30, 'Danube', 2888);

INSERT rivers_countries
VALUES (1, 'BI'),
	(1, 'CD'),
	(1, 'EG'),
	(1, 'ER'),
	(1, 'ET'),
	(1, 'KE'),
	(1, 'RW'),
	(1, 'SD'),
	(1, 'SS'),
	(1, 'TZ'),
	(1, 'UG'),
	(2, 'BO'),
	(2, 'BR'),
	(2, 'CO'),
	(2, 'EC'),
	(2, 'GY'),
	(2, 'PE'),
	(2, 'VE'),
	(3, 'CN'),
	(4, 'CA'),
	(4, 'US'),
	(5, 'MN'),
	(5, 'RU'),
	(6, 'CN'),
	(7, 'CN'),
	(7, 'KZ'),
	(7, 'MN'),
	(7, 'RU'),
	(8, 'AR'),
	(8, 'BO'),
	(8, 'BR'),
	(8, 'PY'),
	(8, 'UY'),
	(9, 'AO'),
	(9, 'BI'),
	(9, 'CD'),
	(9, 'CF'),
	(9, 'CG'),
	(9, 'CM'),
	(9, 'RW'),
	(9, 'TZ'),
	(9, 'ZM'),
	(10, 'CN'),
	(10, 'MN'),
	(10, 'RU'),
	(11, 'RU'),
	(12, 'CN'),
	(12, 'KH'),
	(12, 'LA'),
	(12, 'MM'),
	(12, 'TH'),
	(12, 'VN'),
	(13, 'CA'),
	(14, 'BF'),
	(14, 'BJ'),
	(14, 'CM'),
	(14, 'DZ'),
	(14, 'GN'),
	(14, 'ML'),
	(14, 'NE'),
	(14, 'NG'),
	(14, 'TD'),
	(15, 'AU'),
	(16, 'BR'),
	(17, 'RU'),
	(18, 'IQ'),
	(18, 'SY'),
	(18, 'TR'),
	(19, 'BO'),
	(19, 'BR'),
	(19, 'PE'),
	(20, 'BR'),
	(20, 'PE'),
	(21, 'CA'),
	(21, 'US'),
	(22, 'CN'),
	(22, 'IN'),
	(22, 'PK'),
	(23, 'BR'),
	(24, 'KG'),
	(24, 'KZ'),
	(24, 'TJ'),
	(24, 'UZ'),
	(25, 'CN'),
	(25, 'MM'),
	(25, 'TH'),
	(26, 'CA'),
	(26, 'US'),
	(27, 'MX'),
	(27, 'US'),
	(28, 'RU'),
	(29, 'BD'),
	(29, 'BT'),
	(29, 'CN'),
	(29, 'IN'),
	(29, 'NP'),
	(30, 'AT'),
	(30, 'BG'),
	(30, 'DE'),
	(30, 'HR'),
	(30, 'HU'),
	(30, 'RO'),
	(30, 'RS'),
	(30, 'SK');



go


SELECT TOP 3 WITH TIES ime,duljina FROM Rivers ORDER BY duljina ASC

GO

SELECT ime,ime_stolica FROM Countries WHERE (ime_stolica LIKE 'B%' or ime_stolica LIKE 'C%' or ime_stolica LIKE 'D%' or ime_stolica LIKE 'E%')

go

SELECT ime,code_continent FROM Countries ORDER BY  code_continent ASC

go

SELECT ime,ime_stolica FROM Countries ORDER BY ime_stolica DESC

go

SELECT AVG(duljina) as Средна_дължина_на_всички_реки FROM Rivers

go

SELECT code_continent,ime FROM Countries WHERE(ime_stolica = 'Kinshasa')